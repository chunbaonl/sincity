<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"    
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
    
<mapper namespace="eu.greenhouseinnovation.selly.common.model.dao.ImageGalleryDao">
        
    <select id="getImageGalleriesByLocation" resultMap="imageGalleryResultWithImages">        
        SELECT g.id as galleryid, g.name as galleryname, g.description as gallerydescription, 
               g.slug , 
               gi.`id` as galleryimageid, 
               gi.`caption`,
               gi.`description` 
          FROM galleries g 
LEFT OUTER JOIN galleryimages gi ON gi.`galleryId`=g.`id`
         WHERE g.`shoppingMallId`= #{locationId} AND g.showOnWebsite=1; 
    </select> 
    
    <resultMap id="imageGalleryResultWithImages" type="ImageGallery">        
        <id property="mId" column="galleryid"/>
        <result property="mName" column="galleryname"/>
        <result property="mDescription" column="gallerydescription"/>
        <result property="mSlug" column="slug" />
     
        <collection property="mImagesCollection" column="galleryid" javaType="ArrayList" ofType="ImageGalleryImage">            
            <id property="mId" column="galleryimageid"/>            
            <result property="mCaption" column="caption"/>            
            <result property="mDescription" column="description"/>
            <result property="mThumb" column="galleryimageid"/>
            <result property="mPicture" column="galleryimageid"/>        
        </collection>  
          
    </resultMap>  
    
</mapper>